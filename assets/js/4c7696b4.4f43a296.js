"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4634],{3905:(e,t,r)=>{r.d(t,{Zo:()=>m,kt:()=>u});var a=r(7294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,a,o=function(e,t){if(null==e)return{};var r,a,o={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var p=a.createContext({}),c=function(e){var t=a.useContext(p),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},m=function(e){var t=c(e.components);return a.createElement(p.Provider,{value:t},e.children)},s={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,o=e.mdxType,n=e.originalType,p=e.parentName,m=l(e,["components","mdxType","originalType","parentName"]),d=c(r),u=o,f=d["".concat(p,".").concat(u)]||d[u]||s[u]||n;return r?a.createElement(f,i(i({ref:t},m),{},{components:r})):a.createElement(f,i({ref:t},m))}));function u(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var n=r.length,i=new Array(n);i[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var c=2;c<n;c++)i[c]=r[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},397:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>s,frontMatter:()=>n,metadata:()=>l,toc:()=>c});var a=r(7462),o=(r(7294),r(3905));const n={sidebar_position:1,title:"Deployment via Terraform commands"},i="Deployment via Terraform commands",l={unversionedId:"terraform-cli/cli_deployment/terraform",id:"terraform-cli/cli_deployment/terraform",title:"Deployment via Terraform commands",description:"Navigate to the specific module directory which you are planning to deploy and follow below steps:",source:"@site/docs/terraform-cli/cli_deployment/terraform.md",sourceDirName:"terraform-cli/cli_deployment",slug:"/terraform-cli/cli_deployment/terraform",permalink:"/rad-lab/docs/terraform-cli/cli_deployment/terraform",draft:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Deployment via Terraform commands"},sidebar:"tutorialSidebar",previous:{title:"Module Deployment",permalink:"/rad-lab/docs/cli_deployment"}},p={},c=[{value:"Setup Terraform Backend",id:"setup-terraform-backend",level:2},{value:"Example Configuration",id:"example-configuration",level:3},{value:"Deploy a RAD Lab Module",id:"deploy-a-rad-lab-module",level:2}],m={toc:c};function s(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,a.Z)({},m,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"deployment-via-terraform-commands"},"Deployment via Terraform commands"),(0,o.kt)("p",null,"Navigate to the specific ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/GoogleCloudPlatform/rad-lab/tree/main/modules"},"module")," directory which you are planning to deploy and follow below steps:"),(0,o.kt)("h2",{id:"setup-terraform-backend"},"Setup Terraform Backend"),(0,o.kt)("p",null,"By default, Terraform stores ",(0,o.kt)("a",{parentName:"p",href:"https://www.terraform.io/docs/state/"},"state")," locally in a file named ",(0,o.kt)("inlineCode",{parentName:"p"},"terraform.tfstate"),". This default configuration can make Terraform usage difficult for teams when multiple users run Terraform at the same time and each machine has its own understanding (i.e. state file) of the current infrastructure."),(0,o.kt)("p",null,"To help you avoid such issues, configure a ",(0,o.kt)("a",{parentName:"p",href:"https://www.terraform.io/docs/state/remote.html"},"remote state")," that points to a Cloud Storage bucket. Remote state is a feature of ",(0,o.kt)("a",{parentName:"p",href:"https://www.terraform.io/docs/backends"},"Terraform backends"),". It stores the state as an object in a configurable prefix in a pre-existing bucket on ",(0,o.kt)("a",{parentName:"p",href:"https://cloud.google.com/storage/"},"Google Cloud Storage")," (GCS). The bucket must exist prior to configuring the backend."),(0,o.kt)("p",null,"This backend supports ",(0,o.kt)("a",{parentName:"p",href:"https://developer.hashicorp.com/terraform/language/state/locking"},"state locking"),"."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"It is highly recommended that you enable ",(0,o.kt)("a",{parentName:"p",href:"https://cloud.google.com/storage/docs/object-versioning"},"Object Versioning")," on the GCS bucket to allow for state recovery in the case of accidental deletions and human error.")),(0,o.kt)("h3",{id:"example-configuration"},"Example Configuration"),(0,o.kt)("p",null,"Create a file add the following text to a new Terraform configuration file called ",(0,o.kt)("inlineCode",{parentName:"p"},"backend.tf"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'terraform {\n    backend "gcs" {\n        bucket  = "TF_STATE_BUCKET"\n        prefix  = "PATH_TO_GCS_FOLDER"\n    }\n}\n')),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"TF_STATE_BUCKET"),": ",(0,o.kt)("a",{parentName:"p",href:"/rad-lab/docs/terraform-cli/cli_installation/setup-gcp#gcs-bucket-for-terraform-state"},"GCS Bucket ID")," to store Terraform state."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"PATH_TO_GCS_FOLDER"),": Path to folders/sub-folders within ",(0,o.kt)("em",{parentName:"p"},"TF_STATE_BUCKET"),"."),(0,o.kt)("h2",{id:"deploy-a-rad-lab-module"},"Deploy a RAD Lab Module"),(0,o.kt)("p",null,"Execute below commands in the same order to deploy the module:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Initialise the Terraform codebase\nterraform init -upgrade -reconfigure\n\n# Create the necessary resources\nterraform apply -auto-approve\n")),(0,o.kt)("admonition",{title:"RAD Lab Deployment ID",type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Save the ",(0,o.kt)("strong",{parentName:"p"},"deployment_id")," from the output for future reference. It is required to supply the deployment id for updating or deleting the RAD Lab module deployment.")))}s.isMDXComponent=!0}}]);